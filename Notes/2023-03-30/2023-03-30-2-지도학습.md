---
title: 2. 지도학습
---

# 지도학습

## 개요

> [ 학습 데이터 | 레이블 ] -- ( 입력 ) --> [ 학습 ] ------> 모델(수식)  
>                                           |  
>                                          예측  

- 레이블은 여러 개가 될 수 있다. (다변량)
    - 예) 사람, 남자, 성인
- 그러나 머신러닝에서는 기본적으로 한 개의 레이블을 취급한다 (단변량)

### Regression

| 공부시간 | 성적 |
|------|----|
| 2    |    |
| 5    |    |
| 7    |    |
|      |    |
예측 예시: 6시간 공부했는데, 몇 점 나올까? -> 53점  
연속적인 수로 예측

\* 이 떄의 Regression이란, 머신러닝 기법 중의 Regression이 아니다. 머신러닝 기법인 Regression은 통계학에서 사용되는 알고리즘이며, 여기서의 Regression은 지도학습에서 학습 데이터와 예측치가 연속적인 숫자인 경우를 말하는 분류이다.

### Classification

| 공부시간 | 합격여부 |
|------|------|
| 2    | 0    |
| 5    | 0    |
| 7    | 1    |
| 8    |      |

예측 예시: 6시간 공부했는데, 합격 할 수 있을까? -> 0 (불합격)  
연속적인 수가 아닌, 이산적인 수로 예측

## Regression (회귀)

### 개요

- 통계적 기법
- 어떤 데이터에 대해 그 데이터에 영향을 주는 **조건들의 영향력**을 이용해서 데이터에 대한 조건부 *평균*을 구하는 방법
- 데이터를 가장 잘 표현하는 값을 반환하는 함수를 찾는 것.

- 평균: 대푯값으로 가장 많이 이용하는 값
- 대푯값: 최소값, 최대값, *평균*, 최빈값 등.

- 예시
    - 대한민국의 아파트 가격은?
        - 방법 1
            - 모든 아파트의 가격을 더해 평균을 구함 -> N억
            - 대한민국 아파트의 가격을 대표할 수 있는 값인가?
            - 지역에 따라 위치에 따라 의미 없는 값일 수 있음.
        - **방법 2**
            - 위와 같은 괴리는 아파트 가격이 몇몇 조건에 영향을 받기 때문에 발생. 평수, 학군, 교통, 층 수 등.
                - 이때 각 조건은 가격에 미치는 영향력이 다름.
                - 영향력에 따라 조건에 가중치를 부여하여 가격을 구하는 수식을 작성
                    - 가격 y = 평수 * 8000 + 역세권<0또는1> * 3000 + 인근학교<0또는1> * 5000
                    - 그렇다면 특정 조건 (예컨대 20평, 역세권1, 인근학교1)의 아파트의 평균 가격이 위의 수식의 계산 결과와 가까우면 의미있는 수식이라고 할 수 있음.
                    - 따라서 조건을 설정하고, 조건에 대한 가중치를 설정하여 식을 만드는 것이 주요 작업
                - 수식이 나오면 수식에 조건을 대입하여 값을 예측할 수 있음

### 모델

모델은 수식의 형태이다.

#### 독립변수와 종속변수, 데이터와 레이블

**예시1** 
> BMI지수 = 몸무게(kg) ÷ (신장(m) × 신장(m))

- 독립변수(feature)
    - 위의 예시에서 몸무게와 신장에 해당.
    - 독립적으로 입력되는 값.
    - 비지도학습의 데이터(X-data)에 해당.
- 종속변수(target)
    - 위의 예시에서 BMI 지수에 해당.
    - 독립변수에 의해 결정되는 값.
    - 비지도학습의 레이블에 해당.

**예시2**
| 해외연수기간 | 공부시간 | 성적 |
|--------|------|----|
| 1      | 2    | 10 |
| 3      | 1    | 70 |
| 5      | 10   |    |
성적 → 종속변수, 레이블  
해외연수기간, 공부시간 → 독립변수, 데이터

#### 독립변수가 1개일 때

$$y = \beta_0 x + \beta_1$$

(이때, y는 예측치, x는 독립변수, $b_0$는 가중치, $b_1$은 보정 상수)

이는 y=ax+b 꼴의 1차 함수와 같다.

![25b4745558cad084a8f2e1eaacfbac21.png](Assets/25b4745558cad084a8f2e1eaacfbac21.png)

예컨대, 위와 같은 측정치가 있을 때, 이를 가장 잘 표현하는 직선을 그리는 작업과 같다고 보면 된다.

그렇다면, 독립변수가 2개 이상의 N개라면, 좌표평면이 3차원 이상이 되고, 함수 역시 선이 아닌 면 이상이 될 것이다. 3차원 이상이라면 이해가 어려우므로 독립변수가 1개인 경우를 중심으로 다룰 것이나, 차원이 올라가도 비슷한 패턴이라는 것을 기억하라.

#### 독립변수가 2개일때

이 경우 식이 아래의 꼴을 띤다.
$$y = a x_1 + b x_2 + c$$
이때, y는 예측치, $x_1$ 및 $x_2$는 독립변수, a 및 b는 가중치, c는 보정상수

상술했듯이, 직선이 아니라 y, $x_1$, $x_2$를 축으로 하는 3차원 평면에 그려지는 면이다.

여기서 a, b, c를 회귀계수라고 하며, 이 값을 찾으면 식을 완성할 수 있다.

이러한 수식을 **Classical Linear Regression Model**이라고 한다.

### 적용

회귀를 적용하기 위해서는, 만약 데이터가 평균을 사용하여 잘 표현될 수 있는지를 확인해야 한다. 평균이 의미를 가지지 못하는 데이터의 경우 회귀를 적용하기 어렵다.

- 예컨대 신장에 따른 성인 남성 인구는 정규 분포를 가지므로, 전체 평균이 의미를 가진다.  
- 반면 연봉 분포는 저소득자가 아주 많고, 고소득자가 아주 적으므로, 전체 평균이 의미를 가지지 못한다. 이를 편향된 데이터라고 하며, 이러한 경우에는 회귀를 적용하기 힘들다.

### 회귀는 왜 회귀라고 불리는가

1800년대 찰스 다윈이 <종의 기원>을 쓴 후, 사촌인 프랜시스 골턴은 우생학적 가설을 증명하기 위해 주변 사람들의 키를 전수조사하였다. 이때, 재미있는 것은 키가 큰 아버지라고 해도 아들이 키가 작거나, 키가 작은 아버지라고 해도 아버지보다는 키가 큰 아들이 있었다는 점이다. 즉, 그는 데이터가 평균으로 회귀한다(Regression toward mean)는 것을 발견하였다. 회귀 분석은 이 발견에 바탕한다.

### matplotlib으로 그려보기

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
print('modules imported!')
```

```python
df = pd.DataFrame({
 '공부시간(x)' : [1,2,3,4,5,7,8,10,12,13,14,15,18,20,25,28,30], # 독립변수. data
 '시험점수(t)' : [5,7,20,31,40,44,46,49,60,62,70,80,85,91,92,97,98] # 종속변수. target
})

display(df.head())

# 그래프로 데이터 분포를 알고 싶은 경우
# matplotlib.pyplot.scatter(독립변수_시리즈, 종속변수_시리즈)
plt.scatter(df['공부시간(x)'], df['시험점수(t)'])

# Classical Linear Regression Model 그리기
# y = ax + b 직선
# matplotlib.pyplot.plot(x데이터, t데이터)
plt.plot(df['공부시간(x)'], 2 * df['공부시간(x)'] + 3, color='r')
plt.plot(df['공부시간(x)'], 5 * df['공부시간(x)'] - 7, color='g')
plt.plot(df['공부시간(x)'], 1 * df['공부시간(x)'] + 8, color='b')
plt.plot(df['공부시간(x)'], 4 * df['공부시간(x)'] - 10, color='m')

plt.show()
```

![f7fd11bbc10f5b1670b9cb21fe72c7c3.png](Assets/f7fd11bbc10f5b1670b9cb21fe72c7c3.png)

다양한 모델을 그래프에 나타나보았다. 이렇게 모델을 점차 개선하는 것이 기계 학습에서 말하는 학습이다. 회귀 계수를 정확하게 계산하여 점차 개선된 모델을 찾는 것이다.

