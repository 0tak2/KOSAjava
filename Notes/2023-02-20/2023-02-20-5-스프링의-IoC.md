---
title: 5. 스프링의 IoC
---

# 스프링의 IoC

## 개요

스프링은 상당히 방대한 기능을 가지고 있다. 너무 많아서 모든 내용을 알기가 어려울 정도이다.

> 빈(Bean): 스프링이 제어권을 가지고 직접 만들고 관계를 부여하는 객체. 구체적으로 Application Context에서 관리함.

그 중에서도 가장 핵심 기능은 Bean Factory 기능이다. Bean 이라는 객체를 생성하고 관리하는 팩토리를 말한다. 즉 스프링의 핵심 기능은 Bean이라고 불리는 객체를 관리하는 것에 있다는 것이다.  
조금 더 큰 개념으로 Bean Factory를 Application Context라고 말하기도 하는데, 비슷한 개념이라고 생각하면 된다. 굳이 구분하자면 Application Context 내에 Bean Factory가 있다고 할 수 있다.

Application Context는 IoC 기능을 일반화 시킨 컨테이너이다. 각종 빈 객체를 알아서 Application Context가 만들어 반환해준다. 스프링 개발자는 빈 객체를 직접 만들지 않는다.  
또한 Application Context는 그렇게 반환된 여러 개의 빈을 연결해주는 역할도 수행한다.

그러나 아무런 사전 정보도 없이 Application Context가 자동으로 모든 것을 해주지는 않는다. 설정 정보가 필요하다. Application Context는 어떠한 빈이 필요하고, 각 빈은 어떤 관계를 맺고 있는지를 설정 정보를 통해 알 수 있다.  

설정 정보는 1) XML 문서로 만들 수도 있고, 2) 어노테이션으로 기록할 수도 있다. XML을 쓰면 여러 빈에 대한 설정을 한 눈에 볼 수 있다는 장점이 있다. 그러나 시스템이 커질 수록 빈의 수는 많아질 것이고, 빈 간의 관계가 복잡해질 것이며 XML 파일도 복잡해지게 된다.  
자바 소스코드 내에 어노테이션으로 기록하면 코드를 작성할 때에는 편하겠지만, 스케일이 커지면 설정을 찾는 것부터 어려워진다는 단점이 있다.

## 빈의 구성 요소

![885d18bc9470bb9eda56ab1854d7064d.png](Assets/885d18bc9470bb9eda56ab1854d7064d.png)

1. 클래스: 빈으로 등록할 자바 클래스를 지칭. (풀 패키지 경로로 기술)
2. ID: 빈의 고유 식별자. 이름과 비슷함.
3. 스코프
    - singleton
    - prototype
    - request
    - session
    - 빈은 위의 네 개의 스코프 중 하나를 가질 수 있다.
    - 앞의 두 개는 웹 환경이 아닌 일반적인 경우에 사용하고, 뒤의 두 개는 웹 환경에서 주로 사용한다.
    - 어떻게 설치하는지에 따라 빈의 동작 방식이 달라진다.
4. constructor-arg: Bean 생성시 생성자에게 전달할 인자
5. property: Bean 생성시 setter에게 전달할 인자

⇒ 스프링은 이와 같은 내용을 기반으로 빈을 등록. 스코프를 싱글톤으로 잡으면 싱글톤을 보장함. 즉, 스프링은 등록된 빈을 싱글톤으로 생성하여 관리.

## 빈의 등록

자동 방법과 수동 방법이 있다.

### 수동 방법 (어노테이션)

```java
public class MyResource {
    //
}
```

위와 같은 클래스의 객체를 빈으로 관리하고자 한다면? 설정 정보가 필요하다. 이 설정정보는 상술했듯 XML 혹은 어노테이션으로 작성한다. 

어노테이션으로 설정하기 위해서는, **설정 클래스**를 따로 만들어야 한다. 이 클래스에 어노테이션을 붙여서 설정해준다.

```java
@Configuration // 빈 설정 클래스 자체도 빈이어야 하므로 어노테이션 부착
public class MyResourceConfig { // 이름은 상관 없다
    @Bean // 빈으로 등록
    public MyResource getResource() { // 임의의 메서드 명을 지정
        // 빈으로 등록할 클래스의 인스턴스를 만들어내는 메서드
        return new MyResource();
    }
}
```

Application Context는 이 자바 코드를 빈의 설정 정보로 인식하게 된다. 빈의 구성요소 중 클래스는 'return new MyResource()'에서 규정된다.

빈의 ID는 메소드 이름, 즉 getResource가 된다. ID는 유일해야하므로 다른 빈과 겹치면 안된다.

## 스프링 컨테이너

a.k.a IoC 컨테이너, ApplicationContext, Bean 팩토리

우선 스프링 컨테이너는 @Configuration이 붙은 클래스를 빈으로 등록한다. 이후 해당 클래스 중 @Bean이 붙은 메서드를 찾고, 그 메서드에 의해 생성되는 객체를 빈으로 생성한다.